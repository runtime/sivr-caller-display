{"ast":null,"code":"\"use strict\";\n\nvar __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function step(result) {\n      result.done ? resolve(result.value) : new P(function (resolve) {\n        resolve(result.value);\n      }).then(fulfilled, rejected);\n    }\n\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nconst _ = require(\"lodash\");\n\nconst api = require(\"../api\");\n\nconst error_1 = require(\"../error\");\n\nconst utils_1 = require(\"../utils\");\n\nconst VERSION = \"v1beta1\";\nconst DEFAULT_TIME_ZONE = \"America/Los_Angeles\";\n\nfunction createJob(job) {\n  const strippedName = job.name.substring(0, job.name.lastIndexOf(\"/\"));\n  return api.request(\"POST\", `/${VERSION}/${strippedName}`, {\n    auth: true,\n    origin: api.cloudschedulerOrigin,\n    data: Object.assign({\n      timeZone: DEFAULT_TIME_ZONE\n    }, job)\n  });\n}\n\nexports.createJob = createJob;\n\nfunction deleteJob(name) {\n  return api.request(\"DELETE\", `/${VERSION}/${name}`, {\n    auth: true,\n    origin: api.cloudschedulerOrigin\n  });\n}\n\nexports.deleteJob = deleteJob;\n\nfunction getJob(name) {\n  return api.request(\"GET\", `/${VERSION}/${name}`, {\n    auth: true,\n    origin: api.cloudschedulerOrigin,\n    resolveOnHTTPError: true\n  });\n}\n\nexports.getJob = getJob;\n\nfunction updateJob(job) {\n  return api.request(\"PATCH\", `/${VERSION}/${job.name}`, {\n    auth: true,\n    origin: api.cloudschedulerOrigin,\n    data: Object.assign({\n      timeZone: DEFAULT_TIME_ZONE\n    }, job)\n  });\n}\n\nexports.updateJob = updateJob;\n\nfunction createOrReplaceJob(job) {\n  return __awaiter(this, void 0, void 0, function* () {\n    const jobName = job.name.split(\"/\").pop();\n    const existingJob = yield getJob(job.name);\n\n    if (existingJob.status === 404) {\n      let newJob;\n\n      try {\n        newJob = yield createJob(job);\n      } catch (err) {\n        if (_.get(err, \"context.response.statusCode\") === 404) {\n          return Promise.reject(new error_1.FirebaseError(`Cloud resource location is not set for this project but scheduled functions requires it. ` + `Please see this documentation for more details: https://firebase.google.com/docs/projects/locations.`));\n        }\n      }\n\n      utils_1.logLabeledSuccess(\"functions\", `created scheduler job ${jobName}`);\n      return newJob;\n    }\n\n    if (!job.timeZone) {\n      job.timeZone = DEFAULT_TIME_ZONE;\n    }\n\n    if (isIdentical(existingJob.body, job)) {\n      utils_1.logLabeledBullet(\"functions\", `scheduler job ${jobName} is up to date, no changes required`);\n      return;\n    }\n\n    const updatedJob = yield updateJob(job);\n    utils_1.logLabeledBullet(\"functions\", `updated scheduler job ${jobName}`);\n    return updatedJob;\n  });\n}\n\nexports.createOrReplaceJob = createOrReplaceJob;\n\nfunction isIdentical(job, otherJob) {\n  return job && otherJob && job.schedule === otherJob.schedule && job.timeZone === otherJob.timeZone && _.isEqual(job.retryConfig, otherJob.retryConfig);\n}","map":{"version":3,"sources":["/Users/Erik.Kroha1/Jobs/Verizon/Talk Home/sivr-caller-display/node_modules/firebase-tools/lib/gcp/cloudscheduler.js"],"names":["__awaiter","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","value","step","next","e","rejected","result","done","then","apply","Object","defineProperty","exports","_","require","api","error_1","utils_1","VERSION","DEFAULT_TIME_ZONE","createJob","job","strippedName","name","substring","lastIndexOf","request","auth","origin","cloudschedulerOrigin","data","assign","timeZone","deleteJob","getJob","resolveOnHTTPError","updateJob","createOrReplaceJob","jobName","split","pop","existingJob","status","newJob","err","get","FirebaseError","logLabeledSuccess","isIdentical","body","logLabeledBullet","updatedJob","otherJob","schedule","isEqual","retryConfig"],"mappings":"AAAA;;AACA,IAAIA,SAAS,GAAI,QAAQ,KAAKA,SAAd,IAA4B,UAAUC,OAAV,EAAmBC,UAAnB,EAA+BC,CAA/B,EAAkCC,SAAlC,EAA6C;AACrF,SAAO,KAAKD,CAAC,KAAKA,CAAC,GAAGE,OAAT,CAAN,EAAyB,UAAUC,OAAV,EAAmBC,MAAnB,EAA2B;AACvD,aAASC,SAAT,CAAmBC,KAAnB,EAA0B;AAAE,UAAI;AAAEC,QAAAA,IAAI,CAACN,SAAS,CAACO,IAAV,CAAeF,KAAf,CAAD,CAAJ;AAA8B,OAApC,CAAqC,OAAOG,CAAP,EAAU;AAAEL,QAAAA,MAAM,CAACK,CAAD,CAAN;AAAY;AAAE;;AAC3F,aAASC,QAAT,CAAkBJ,KAAlB,EAAyB;AAAE,UAAI;AAAEC,QAAAA,IAAI,CAACN,SAAS,CAAC,OAAD,CAAT,CAAmBK,KAAnB,CAAD,CAAJ;AAAkC,OAAxC,CAAyC,OAAOG,CAAP,EAAU;AAAEL,QAAAA,MAAM,CAACK,CAAD,CAAN;AAAY;AAAE;;AAC9F,aAASF,IAAT,CAAcI,MAAd,EAAsB;AAAEA,MAAAA,MAAM,CAACC,IAAP,GAAcT,OAAO,CAACQ,MAAM,CAACL,KAAR,CAArB,GAAsC,IAAIN,CAAJ,CAAM,UAAUG,OAAV,EAAmB;AAAEA,QAAAA,OAAO,CAACQ,MAAM,CAACL,KAAR,CAAP;AAAwB,OAAnD,EAAqDO,IAArD,CAA0DR,SAA1D,EAAqEK,QAArE,CAAtC;AAAuH;;AAC/IH,IAAAA,IAAI,CAAC,CAACN,SAAS,GAAGA,SAAS,CAACa,KAAV,CAAgBhB,OAAhB,EAAyBC,UAAU,IAAI,EAAvC,CAAb,EAAyDS,IAAzD,EAAD,CAAJ;AACH,GALM,CAAP;AAMH,CAPD;;AAQAO,MAAM,CAACC,cAAP,CAAsBC,OAAtB,EAA+B,YAA/B,EAA6C;AAAEX,EAAAA,KAAK,EAAE;AAAT,CAA7C;;AACA,MAAMY,CAAC,GAAGC,OAAO,CAAC,QAAD,CAAjB;;AACA,MAAMC,GAAG,GAAGD,OAAO,CAAC,QAAD,CAAnB;;AACA,MAAME,OAAO,GAAGF,OAAO,CAAC,UAAD,CAAvB;;AACA,MAAMG,OAAO,GAAGH,OAAO,CAAC,UAAD,CAAvB;;AACA,MAAMI,OAAO,GAAG,SAAhB;AACA,MAAMC,iBAAiB,GAAG,qBAA1B;;AACA,SAASC,SAAT,CAAmBC,GAAnB,EAAwB;AACpB,QAAMC,YAAY,GAAGD,GAAG,CAACE,IAAJ,CAASC,SAAT,CAAmB,CAAnB,EAAsBH,GAAG,CAACE,IAAJ,CAASE,WAAT,CAAqB,GAArB,CAAtB,CAArB;AACA,SAAOV,GAAG,CAACW,OAAJ,CAAY,MAAZ,EAAqB,IAAGR,OAAQ,IAAGI,YAAa,EAAhD,EAAmD;AACtDK,IAAAA,IAAI,EAAE,IADgD;AAEtDC,IAAAA,MAAM,EAAEb,GAAG,CAACc,oBAF0C;AAGtDC,IAAAA,IAAI,EAAEpB,MAAM,CAACqB,MAAP,CAAc;AAAEC,MAAAA,QAAQ,EAAEb;AAAZ,KAAd,EAA+CE,GAA/C;AAHgD,GAAnD,CAAP;AAKH;;AACDT,OAAO,CAACQ,SAAR,GAAoBA,SAApB;;AACA,SAASa,SAAT,CAAmBV,IAAnB,EAAyB;AACrB,SAAOR,GAAG,CAACW,OAAJ,CAAY,QAAZ,EAAuB,IAAGR,OAAQ,IAAGK,IAAK,EAA1C,EAA6C;AAChDI,IAAAA,IAAI,EAAE,IAD0C;AAEhDC,IAAAA,MAAM,EAAEb,GAAG,CAACc;AAFoC,GAA7C,CAAP;AAIH;;AACDjB,OAAO,CAACqB,SAAR,GAAoBA,SAApB;;AACA,SAASC,MAAT,CAAgBX,IAAhB,EAAsB;AAClB,SAAOR,GAAG,CAACW,OAAJ,CAAY,KAAZ,EAAoB,IAAGR,OAAQ,IAAGK,IAAK,EAAvC,EAA0C;AAC7CI,IAAAA,IAAI,EAAE,IADuC;AAE7CC,IAAAA,MAAM,EAAEb,GAAG,CAACc,oBAFiC;AAG7CM,IAAAA,kBAAkB,EAAE;AAHyB,GAA1C,CAAP;AAKH;;AACDvB,OAAO,CAACsB,MAAR,GAAiBA,MAAjB;;AACA,SAASE,SAAT,CAAmBf,GAAnB,EAAwB;AACpB,SAAON,GAAG,CAACW,OAAJ,CAAY,OAAZ,EAAsB,IAAGR,OAAQ,IAAGG,GAAG,CAACE,IAAK,EAA7C,EAAgD;AACnDI,IAAAA,IAAI,EAAE,IAD6C;AAEnDC,IAAAA,MAAM,EAAEb,GAAG,CAACc,oBAFuC;AAGnDC,IAAAA,IAAI,EAAEpB,MAAM,CAACqB,MAAP,CAAc;AAAEC,MAAAA,QAAQ,EAAEb;AAAZ,KAAd,EAA+CE,GAA/C;AAH6C,GAAhD,CAAP;AAKH;;AACDT,OAAO,CAACwB,SAAR,GAAoBA,SAApB;;AACA,SAASC,kBAAT,CAA4BhB,GAA5B,EAAiC;AAC7B,SAAO7B,SAAS,CAAC,IAAD,EAAO,KAAK,CAAZ,EAAe,KAAK,CAApB,EAAuB,aAAa;AAChD,UAAM8C,OAAO,GAAGjB,GAAG,CAACE,IAAJ,CAASgB,KAAT,CAAe,GAAf,EAAoBC,GAApB,EAAhB;AACA,UAAMC,WAAW,GAAG,MAAMP,MAAM,CAACb,GAAG,CAACE,IAAL,CAAhC;;AACA,QAAIkB,WAAW,CAACC,MAAZ,KAAuB,GAA3B,EAAgC;AAC5B,UAAIC,MAAJ;;AACA,UAAI;AACAA,QAAAA,MAAM,GAAG,MAAMvB,SAAS,CAACC,GAAD,CAAxB;AACH,OAFD,CAGA,OAAOuB,GAAP,EAAY;AACR,YAAI/B,CAAC,CAACgC,GAAF,CAAMD,GAAN,EAAW,6BAAX,MAA8C,GAAlD,EAAuD;AACnD,iBAAO/C,OAAO,CAACE,MAAR,CAAe,IAAIiB,OAAO,CAAC8B,aAAZ,CAA2B,2FAAD,GAC3C,sGADiB,CAAf,CAAP;AAEH;AACJ;;AACD7B,MAAAA,OAAO,CAAC8B,iBAAR,CAA0B,WAA1B,EAAwC,yBAAwBT,OAAQ,EAAxE;AACA,aAAOK,MAAP;AACH;;AACD,QAAI,CAACtB,GAAG,CAACW,QAAT,EAAmB;AACfX,MAAAA,GAAG,CAACW,QAAJ,GAAeb,iBAAf;AACH;;AACD,QAAI6B,WAAW,CAACP,WAAW,CAACQ,IAAb,EAAmB5B,GAAnB,CAAf,EAAwC;AACpCJ,MAAAA,OAAO,CAACiC,gBAAR,CAAyB,WAAzB,EAAuC,iBAAgBZ,OAAQ,qCAA/D;AACA;AACH;;AACD,UAAMa,UAAU,GAAG,MAAMf,SAAS,CAACf,GAAD,CAAlC;AACAJ,IAAAA,OAAO,CAACiC,gBAAR,CAAyB,WAAzB,EAAuC,yBAAwBZ,OAAQ,EAAvE;AACA,WAAOa,UAAP;AACH,GA3Be,CAAhB;AA4BH;;AACDvC,OAAO,CAACyB,kBAAR,GAA6BA,kBAA7B;;AACA,SAASW,WAAT,CAAqB3B,GAArB,EAA0B+B,QAA1B,EAAoC;AAChC,SAAQ/B,GAAG,IACP+B,QADI,IAEJ/B,GAAG,CAACgC,QAAJ,KAAiBD,QAAQ,CAACC,QAFtB,IAGJhC,GAAG,CAACW,QAAJ,KAAiBoB,QAAQ,CAACpB,QAHtB,IAIJnB,CAAC,CAACyC,OAAF,CAAUjC,GAAG,CAACkC,WAAd,EAA2BH,QAAQ,CAACG,WAApC,CAJJ;AAKH","sourcesContent":["\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst _ = require(\"lodash\");\nconst api = require(\"../api\");\nconst error_1 = require(\"../error\");\nconst utils_1 = require(\"../utils\");\nconst VERSION = \"v1beta1\";\nconst DEFAULT_TIME_ZONE = \"America/Los_Angeles\";\nfunction createJob(job) {\n    const strippedName = job.name.substring(0, job.name.lastIndexOf(\"/\"));\n    return api.request(\"POST\", `/${VERSION}/${strippedName}`, {\n        auth: true,\n        origin: api.cloudschedulerOrigin,\n        data: Object.assign({ timeZone: DEFAULT_TIME_ZONE }, job),\n    });\n}\nexports.createJob = createJob;\nfunction deleteJob(name) {\n    return api.request(\"DELETE\", `/${VERSION}/${name}`, {\n        auth: true,\n        origin: api.cloudschedulerOrigin,\n    });\n}\nexports.deleteJob = deleteJob;\nfunction getJob(name) {\n    return api.request(\"GET\", `/${VERSION}/${name}`, {\n        auth: true,\n        origin: api.cloudschedulerOrigin,\n        resolveOnHTTPError: true,\n    });\n}\nexports.getJob = getJob;\nfunction updateJob(job) {\n    return api.request(\"PATCH\", `/${VERSION}/${job.name}`, {\n        auth: true,\n        origin: api.cloudschedulerOrigin,\n        data: Object.assign({ timeZone: DEFAULT_TIME_ZONE }, job),\n    });\n}\nexports.updateJob = updateJob;\nfunction createOrReplaceJob(job) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const jobName = job.name.split(\"/\").pop();\n        const existingJob = yield getJob(job.name);\n        if (existingJob.status === 404) {\n            let newJob;\n            try {\n                newJob = yield createJob(job);\n            }\n            catch (err) {\n                if (_.get(err, \"context.response.statusCode\") === 404) {\n                    return Promise.reject(new error_1.FirebaseError(`Cloud resource location is not set for this project but scheduled functions requires it. ` +\n                        `Please see this documentation for more details: https://firebase.google.com/docs/projects/locations.`));\n                }\n            }\n            utils_1.logLabeledSuccess(\"functions\", `created scheduler job ${jobName}`);\n            return newJob;\n        }\n        if (!job.timeZone) {\n            job.timeZone = DEFAULT_TIME_ZONE;\n        }\n        if (isIdentical(existingJob.body, job)) {\n            utils_1.logLabeledBullet(\"functions\", `scheduler job ${jobName} is up to date, no changes required`);\n            return;\n        }\n        const updatedJob = yield updateJob(job);\n        utils_1.logLabeledBullet(\"functions\", `updated scheduler job ${jobName}`);\n        return updatedJob;\n    });\n}\nexports.createOrReplaceJob = createOrReplaceJob;\nfunction isIdentical(job, otherJob) {\n    return (job &&\n        otherJob &&\n        job.schedule === otherJob.schedule &&\n        job.timeZone === otherJob.timeZone &&\n        _.isEqual(job.retryConfig, otherJob.retryConfig));\n}\n"]},"metadata":{},"sourceType":"script"}