{"ast":null,"code":"\"use strict\";\n\nvar logger = require(\"../logger\");\n\nvar api = require(\"../api\");\n\nvar clc = require(\"cli-color\");\n\nvar _ = require(\"lodash\");\n\nvar getProjectId = require(\"../getProjectId\");\n\nvar utils = require(\"../utils\");\n\nvar _require = require(\"../error\"),\n    FirebaseError = _require.FirebaseError;\n\nvar track = require(\"../track\");\n\nvar lifecycleHooks = require(\"./lifecycleHooks\");\n\nvar TARGETS = {\n  hosting: require(\"./hosting\"),\n  database: require(\"./database\"),\n  firestore: require(\"./firestore\"),\n  functions: require(\"./functions\"),\n  storage: require(\"./storage\")\n};\n\nvar _noop = function () {\n  return Promise.resolve();\n};\n\nvar _chain = function (fns, context, options, payload) {\n  var latest = (fns.shift() || _noop)(context, options, payload);\n\n  if (fns.length) {\n    return latest.then(function () {\n      return _chain(fns, context, options, payload);\n    });\n  }\n\n  return latest;\n};\n\nvar deploy = function (targetNames, options) {\n  var projectId = getProjectId(options);\n  var payload = {};\n  var context = {\n    projectId: projectId\n  };\n  var predeploys = [];\n  var prepares = [];\n  var deploys = [];\n  var releases = [];\n  var postdeploys = [];\n\n  for (var i = 0; i < targetNames.length; i++) {\n    var targetName = targetNames[i];\n    var target = TARGETS[targetName];\n\n    if (!target) {\n      return Promise.reject(new FirebaseError(clc.bold(targetName) + \" is not a valid deploy target\", {\n        exit: 1\n      }));\n    }\n\n    predeploys.push(lifecycleHooks(targetName, \"predeploy\"));\n\n    if (target.prepare) {\n      prepares.push(target.prepare);\n    }\n\n    if (target.deploy) {\n      deploys.push(target.deploy);\n    }\n\n    if (target.release) {\n      releases.push(target.release);\n    }\n\n    postdeploys.push(lifecycleHooks(targetName, \"postdeploy\"));\n  }\n\n  logger.info();\n  logger.info(clc.bold(clc.white(\"===\") + \" Deploying to '\" + projectId + \"'...\"));\n  logger.info();\n  utils.logBullet(\"deploying \" + clc.bold(targetNames.join(\", \")));\n  return _chain(predeploys, context, options, payload).then(function () {\n    return _chain(prepares, context, options, payload);\n  }).then(function () {\n    return _chain(deploys, context, options, payload);\n  }).then(function () {\n    return _chain(releases, context, options, payload);\n  }).then(function () {\n    return _chain(postdeploys, context, options, payload);\n  }).then(function () {\n    if (_.has(options, \"config.notes.databaseRules\")) {\n      track(\"Rules Deploy\", options.config.notes.databaseRules);\n    }\n\n    logger.info();\n    utils.logSuccess(clc.underline.bold(\"Deploy complete!\"));\n    logger.info();\n\n    var deployedHosting = _.includes(targetNames, \"hosting\");\n\n    logger.info(clc.bold(\"Project Console:\"), utils.consoleUrl(options.project, \"/overview\"));\n\n    if (deployedHosting) {\n      _.each(context.hosting.deploys, function (deploy) {\n        logger.info(clc.bold(\"Hosting URL:\"), utils.addSubdomain(api.hostingOrigin, deploy.site));\n      });\n\n      const versionNames = context.hosting.deploys.map(deploy => deploy.version);\n      return {\n        hosting: versionNames.length === 1 ? versionNames[0] : versionNames\n      };\n    }\n  });\n};\n\ndeploy.TARGETS = TARGETS;\nmodule.exports = deploy;","map":{"version":3,"sources":["/Users/Erik.Kroha1/Jobs/Verizon/Talk Home/sivr-caller-display/node_modules/firebase-tools/lib/deploy/index.js"],"names":["logger","require","api","clc","_","getProjectId","utils","FirebaseError","track","lifecycleHooks","TARGETS","hosting","database","firestore","functions","storage","_noop","Promise","resolve","_chain","fns","context","options","payload","latest","shift","length","then","deploy","targetNames","projectId","predeploys","prepares","deploys","releases","postdeploys","i","targetName","target","reject","bold","exit","push","prepare","release","info","white","logBullet","join","has","config","notes","databaseRules","logSuccess","underline","deployedHosting","includes","consoleUrl","project","each","addSubdomain","hostingOrigin","site","versionNames","map","version","module","exports"],"mappings":"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","sourcesContent":["\"use strict\";\nvar logger = require(\"../logger\");\nvar api = require(\"../api\");\nvar clc = require(\"cli-color\");\nvar _ = require(\"lodash\");\nvar getProjectId = require(\"../getProjectId\");\nvar utils = require(\"../utils\");\nvar { FirebaseError } = require(\"../error\");\nvar track = require(\"../track\");\nvar lifecycleHooks = require(\"./lifecycleHooks\");\nvar TARGETS = {\n    hosting: require(\"./hosting\"),\n    database: require(\"./database\"),\n    firestore: require(\"./firestore\"),\n    functions: require(\"./functions\"),\n    storage: require(\"./storage\"),\n};\nvar _noop = function () {\n    return Promise.resolve();\n};\nvar _chain = function (fns, context, options, payload) {\n    var latest = (fns.shift() || _noop)(context, options, payload);\n    if (fns.length) {\n        return latest.then(function () {\n            return _chain(fns, context, options, payload);\n        });\n    }\n    return latest;\n};\nvar deploy = function (targetNames, options) {\n    var projectId = getProjectId(options);\n    var payload = {};\n    var context = { projectId: projectId };\n    var predeploys = [];\n    var prepares = [];\n    var deploys = [];\n    var releases = [];\n    var postdeploys = [];\n    for (var i = 0; i < targetNames.length; i++) {\n        var targetName = targetNames[i];\n        var target = TARGETS[targetName];\n        if (!target) {\n            return Promise.reject(new FirebaseError(clc.bold(targetName) + \" is not a valid deploy target\", { exit: 1 }));\n        }\n        predeploys.push(lifecycleHooks(targetName, \"predeploy\"));\n        if (target.prepare) {\n            prepares.push(target.prepare);\n        }\n        if (target.deploy) {\n            deploys.push(target.deploy);\n        }\n        if (target.release) {\n            releases.push(target.release);\n        }\n        postdeploys.push(lifecycleHooks(targetName, \"postdeploy\"));\n    }\n    logger.info();\n    logger.info(clc.bold(clc.white(\"===\") + \" Deploying to '\" + projectId + \"'...\"));\n    logger.info();\n    utils.logBullet(\"deploying \" + clc.bold(targetNames.join(\", \")));\n    return _chain(predeploys, context, options, payload)\n        .then(function () {\n        return _chain(prepares, context, options, payload);\n    })\n        .then(function () {\n        return _chain(deploys, context, options, payload);\n    })\n        .then(function () {\n        return _chain(releases, context, options, payload);\n    })\n        .then(function () {\n        return _chain(postdeploys, context, options, payload);\n    })\n        .then(function () {\n        if (_.has(options, \"config.notes.databaseRules\")) {\n            track(\"Rules Deploy\", options.config.notes.databaseRules);\n        }\n        logger.info();\n        utils.logSuccess(clc.underline.bold(\"Deploy complete!\"));\n        logger.info();\n        var deployedHosting = _.includes(targetNames, \"hosting\");\n        logger.info(clc.bold(\"Project Console:\"), utils.consoleUrl(options.project, \"/overview\"));\n        if (deployedHosting) {\n            _.each(context.hosting.deploys, function (deploy) {\n                logger.info(clc.bold(\"Hosting URL:\"), utils.addSubdomain(api.hostingOrigin, deploy.site));\n            });\n            const versionNames = context.hosting.deploys.map((deploy) => deploy.version);\n            return { hosting: versionNames.length === 1 ? versionNames[0] : versionNames };\n        }\n    });\n};\ndeploy.TARGETS = TARGETS;\nmodule.exports = deploy;\n"]},"metadata":{},"sourceType":"script"}