{"ast":null,"code":"\"use strict\";\n\nvar __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function step(result) {\n      result.done ? resolve(result.value) : new P(function (resolve) {\n        resolve(result.value);\n      }).then(fulfilled, rejected);\n    }\n\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nconst _ = require(\"lodash\");\n\nconst clc = require(\"cli-color\");\n\nconst stream_1 = require(\"stream\");\n\nconst configstore = require(\"./configstore\");\n\nconst error_1 = require(\"./error\");\n\nconst logger = require(\"./logger\");\n\nconst IS_WINDOWS = process.platform === \"win32\";\nconst SUCCESS_CHAR = IS_WINDOWS ? \"+\" : \"✔\";\nconst WARNING_CHAR = IS_WINDOWS ? \"!\" : \"⚠\";\nexports.envOverrides = [];\n\nfunction consoleUrl(project, path) {\n  const api = require(\"./api\");\n\n  return `${api.consoleOrigin}/project/${project}${path}`;\n}\n\nexports.consoleUrl = consoleUrl;\n\nfunction getInheritedOption(options, key) {\n  let target = options;\n\n  while (target) {\n    if (_.has(target, key)) {\n      return target[key];\n    }\n\n    target = target.parent;\n  }\n}\n\nexports.getInheritedOption = getInheritedOption;\n\nfunction envOverride(envname, value, coerce) {\n  const currentEnvValue = process.env[envname];\n\n  if (currentEnvValue && currentEnvValue.length) {\n    exports.envOverrides.push(envname);\n\n    if (coerce) {\n      try {\n        return coerce(currentEnvValue, value);\n      } catch (e) {\n        return value;\n      }\n    }\n\n    return currentEnvValue;\n  }\n\n  return value;\n}\n\nexports.envOverride = envOverride;\n\nfunction addSubdomain(origin, subdomain) {\n  return origin.replace(\"//\", `//${subdomain}.`);\n}\n\nexports.addSubdomain = addSubdomain;\n\nfunction logSuccess(message, type = \"info\") {\n  logger[type](clc.green.bold(`${SUCCESS_CHAR} `), message);\n}\n\nexports.logSuccess = logSuccess;\n\nfunction logLabeledSuccess(label, message, type = \"info\") {\n  logger[type](clc.green.bold(`${SUCCESS_CHAR}  ${label}:`), message);\n}\n\nexports.logLabeledSuccess = logLabeledSuccess;\n\nfunction logBullet(message, type = \"info\") {\n  logger[type](clc.cyan.bold(\"i \"), message);\n}\n\nexports.logBullet = logBullet;\n\nfunction logLabeledBullet(label, message, type = \"info\") {\n  logger[type](clc.cyan.bold(`i  ${label}:`), message);\n}\n\nexports.logLabeledBullet = logLabeledBullet;\n\nfunction logWarning(message, type = \"warn\") {\n  logger[type](clc.yellow.bold(`${WARNING_CHAR} `), message);\n}\n\nexports.logWarning = logWarning;\n\nfunction logLabeledWarning(label, message, type = \"warn\") {\n  logger[type](clc.yellow.bold(`${WARNING_CHAR}  ${label}:`), message);\n}\n\nexports.logLabeledWarning = logLabeledWarning;\n\nfunction reject(message, options) {\n  return Promise.reject(new error_1.FirebaseError(message, options));\n}\n\nexports.reject = reject;\n\nfunction explainStdin() {\n  if (IS_WINDOWS) {\n    throw new error_1.FirebaseError(\"STDIN input is not available on Windows.\", {\n      exit: 1\n    });\n  }\n\n  if (process.stdin.isTTY) {\n    logger.info(clc.bold(\"Note:\"), \"Reading STDIN. Type JSON data and then press Ctrl-D\");\n  }\n}\n\nexports.explainStdin = explainStdin;\n\nfunction stringToStream(text) {\n  if (!text) {\n    return undefined;\n  }\n\n  const s = new stream_1.Readable();\n  s.push(text);\n  s.push(null);\n  return s;\n}\n\nexports.stringToStream = stringToStream;\n\nfunction makeActiveProject(projectDir, newActive) {\n  const activeProjects = configstore.get(\"activeProjects\") || {};\n\n  if (newActive) {\n    activeProjects[projectDir] = newActive;\n  } else {\n    _.unset(activeProjects, projectDir);\n  }\n\n  configstore.set(\"activeProjects\", activeProjects);\n}\n\nexports.makeActiveProject = makeActiveProject;\n\nfunction endpoint(parts) {\n  return `/${_.join(parts, \"/\")}`;\n}\n\nexports.endpoint = endpoint;\n\nfunction getFunctionsEventProvider(eventType) {\n  const parts = eventType.split(\"/\");\n\n  if (parts.length > 1) {\n    const provider = _.last(parts[1].split(\".\"));\n\n    return _.capitalize(provider);\n  }\n\n  if (eventType.match(/google.pubsub/)) {\n    return \"PubSub\";\n  } else if (eventType.match(/google.storage/)) {\n    return \"Storage\";\n  } else if (eventType.match(/google.analytics/)) {\n    return \"Analytics\";\n  } else if (eventType.match(/google.firebase.database/)) {\n    return \"Database\";\n  } else if (eventType.match(/google.firebase.auth/)) {\n    return \"Auth\";\n  } else if (eventType.match(/google.firebase.crashlytics/)) {\n    return \"Crashlytics\";\n  } else if (eventType.match(/google.firestore/)) {\n    return \"Firestore\";\n  }\n\n  return _.capitalize(eventType.split(\".\")[1]);\n}\n\nexports.getFunctionsEventProvider = getFunctionsEventProvider;\n\nfunction promiseAllSettled(promises) {\n  const wrappedPromises = _.map(promises, p => __awaiter(this, void 0, void 0, function* () {\n    try {\n      const val = yield Promise.resolve(p);\n      return {\n        state: \"fulfilled\",\n        value: val\n      };\n    } catch (err) {\n      return {\n        state: \"rejected\",\n        reason: err\n      };\n    }\n  }));\n\n  return Promise.all(wrappedPromises);\n}\n\nexports.promiseAllSettled = promiseAllSettled;\n\nfunction promiseWhile(action, check, interval = 2500) {\n  return __awaiter(this, void 0, void 0, function* () {\n    return new Promise((resolve, promiseReject) => {\n      const run = () => __awaiter(this, void 0, void 0, function* () {\n        try {\n          const res = yield action();\n\n          if (check(res)) {\n            return resolve(res);\n          }\n\n          setTimeout(run, interval);\n        } catch (err) {\n          return promiseReject(err);\n        }\n      });\n\n      run();\n    });\n  });\n}\n\nexports.promiseWhile = promiseWhile;\n\nfunction promiseProps(obj) {\n  return __awaiter(this, void 0, void 0, function* () {\n    const resultObj = {};\n\n    const promises = _.keys(obj).map(key => __awaiter(this, void 0, void 0, function* () {\n      const r = yield Promise.resolve(obj[key]);\n      resultObj[key] = r;\n    }));\n\n    return Promise.all(promises).then(() => resultObj);\n  });\n}\n\nexports.promiseProps = promiseProps;","map":{"version":3,"sources":["/Users/Erik.Kroha1/Jobs/Verizon/Talk Home/sivr-caller-display/node_modules/firebase-tools/lib/utils.js"],"names":["__awaiter","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","value","step","next","e","rejected","result","done","then","apply","Object","defineProperty","exports","_","require","clc","stream_1","configstore","error_1","logger","IS_WINDOWS","process","platform","SUCCESS_CHAR","WARNING_CHAR","envOverrides","consoleUrl","project","path","api","consoleOrigin","getInheritedOption","options","key","target","has","parent","envOverride","envname","coerce","currentEnvValue","env","length","push","addSubdomain","origin","subdomain","replace","logSuccess","message","type","green","bold","logLabeledSuccess","label","logBullet","cyan","logLabeledBullet","logWarning","yellow","logLabeledWarning","FirebaseError","explainStdin","exit","stdin","isTTY","info","stringToStream","text","undefined","s","Readable","makeActiveProject","projectDir","newActive","activeProjects","get","unset","set","endpoint","parts","join","getFunctionsEventProvider","eventType","split","provider","last","capitalize","match","promiseAllSettled","promises","wrappedPromises","map","p","val","state","err","reason","all","promiseWhile","action","check","interval","promiseReject","run","res","setTimeout","promiseProps","obj","resultObj","keys","r"],"mappings":"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","sourcesContent":["\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst _ = require(\"lodash\");\nconst clc = require(\"cli-color\");\nconst stream_1 = require(\"stream\");\nconst configstore = require(\"./configstore\");\nconst error_1 = require(\"./error\");\nconst logger = require(\"./logger\");\nconst IS_WINDOWS = process.platform === \"win32\";\nconst SUCCESS_CHAR = IS_WINDOWS ? \"+\" : \"✔\";\nconst WARNING_CHAR = IS_WINDOWS ? \"!\" : \"⚠\";\nexports.envOverrides = [];\nfunction consoleUrl(project, path) {\n    const api = require(\"./api\");\n    return `${api.consoleOrigin}/project/${project}${path}`;\n}\nexports.consoleUrl = consoleUrl;\nfunction getInheritedOption(options, key) {\n    let target = options;\n    while (target) {\n        if (_.has(target, key)) {\n            return target[key];\n        }\n        target = target.parent;\n    }\n}\nexports.getInheritedOption = getInheritedOption;\nfunction envOverride(envname, value, coerce) {\n    const currentEnvValue = process.env[envname];\n    if (currentEnvValue && currentEnvValue.length) {\n        exports.envOverrides.push(envname);\n        if (coerce) {\n            try {\n                return coerce(currentEnvValue, value);\n            }\n            catch (e) {\n                return value;\n            }\n        }\n        return currentEnvValue;\n    }\n    return value;\n}\nexports.envOverride = envOverride;\nfunction addSubdomain(origin, subdomain) {\n    return origin.replace(\"//\", `//${subdomain}.`);\n}\nexports.addSubdomain = addSubdomain;\nfunction logSuccess(message, type = \"info\") {\n    logger[type](clc.green.bold(`${SUCCESS_CHAR} `), message);\n}\nexports.logSuccess = logSuccess;\nfunction logLabeledSuccess(label, message, type = \"info\") {\n    logger[type](clc.green.bold(`${SUCCESS_CHAR}  ${label}:`), message);\n}\nexports.logLabeledSuccess = logLabeledSuccess;\nfunction logBullet(message, type = \"info\") {\n    logger[type](clc.cyan.bold(\"i \"), message);\n}\nexports.logBullet = logBullet;\nfunction logLabeledBullet(label, message, type = \"info\") {\n    logger[type](clc.cyan.bold(`i  ${label}:`), message);\n}\nexports.logLabeledBullet = logLabeledBullet;\nfunction logWarning(message, type = \"warn\") {\n    logger[type](clc.yellow.bold(`${WARNING_CHAR} `), message);\n}\nexports.logWarning = logWarning;\nfunction logLabeledWarning(label, message, type = \"warn\") {\n    logger[type](clc.yellow.bold(`${WARNING_CHAR}  ${label}:`), message);\n}\nexports.logLabeledWarning = logLabeledWarning;\nfunction reject(message, options) {\n    return Promise.reject(new error_1.FirebaseError(message, options));\n}\nexports.reject = reject;\nfunction explainStdin() {\n    if (IS_WINDOWS) {\n        throw new error_1.FirebaseError(\"STDIN input is not available on Windows.\", {\n            exit: 1,\n        });\n    }\n    if (process.stdin.isTTY) {\n        logger.info(clc.bold(\"Note:\"), \"Reading STDIN. Type JSON data and then press Ctrl-D\");\n    }\n}\nexports.explainStdin = explainStdin;\nfunction stringToStream(text) {\n    if (!text) {\n        return undefined;\n    }\n    const s = new stream_1.Readable();\n    s.push(text);\n    s.push(null);\n    return s;\n}\nexports.stringToStream = stringToStream;\nfunction makeActiveProject(projectDir, newActive) {\n    const activeProjects = configstore.get(\"activeProjects\") || {};\n    if (newActive) {\n        activeProjects[projectDir] = newActive;\n    }\n    else {\n        _.unset(activeProjects, projectDir);\n    }\n    configstore.set(\"activeProjects\", activeProjects);\n}\nexports.makeActiveProject = makeActiveProject;\nfunction endpoint(parts) {\n    return `/${_.join(parts, \"/\")}`;\n}\nexports.endpoint = endpoint;\nfunction getFunctionsEventProvider(eventType) {\n    const parts = eventType.split(\"/\");\n    if (parts.length > 1) {\n        const provider = _.last(parts[1].split(\".\"));\n        return _.capitalize(provider);\n    }\n    if (eventType.match(/google.pubsub/)) {\n        return \"PubSub\";\n    }\n    else if (eventType.match(/google.storage/)) {\n        return \"Storage\";\n    }\n    else if (eventType.match(/google.analytics/)) {\n        return \"Analytics\";\n    }\n    else if (eventType.match(/google.firebase.database/)) {\n        return \"Database\";\n    }\n    else if (eventType.match(/google.firebase.auth/)) {\n        return \"Auth\";\n    }\n    else if (eventType.match(/google.firebase.crashlytics/)) {\n        return \"Crashlytics\";\n    }\n    else if (eventType.match(/google.firestore/)) {\n        return \"Firestore\";\n    }\n    return _.capitalize(eventType.split(\".\")[1]);\n}\nexports.getFunctionsEventProvider = getFunctionsEventProvider;\nfunction promiseAllSettled(promises) {\n    const wrappedPromises = _.map(promises, (p) => __awaiter(this, void 0, void 0, function* () {\n        try {\n            const val = yield Promise.resolve(p);\n            return { state: \"fulfilled\", value: val };\n        }\n        catch (err) {\n            return { state: \"rejected\", reason: err };\n        }\n    }));\n    return Promise.all(wrappedPromises);\n}\nexports.promiseAllSettled = promiseAllSettled;\nfunction promiseWhile(action, check, interval = 2500) {\n    return __awaiter(this, void 0, void 0, function* () {\n        return new Promise((resolve, promiseReject) => {\n            const run = () => __awaiter(this, void 0, void 0, function* () {\n                try {\n                    const res = yield action();\n                    if (check(res)) {\n                        return resolve(res);\n                    }\n                    setTimeout(run, interval);\n                }\n                catch (err) {\n                    return promiseReject(err);\n                }\n            });\n            run();\n        });\n    });\n}\nexports.promiseWhile = promiseWhile;\nfunction promiseProps(obj) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const resultObj = {};\n        const promises = _.keys(obj).map((key) => __awaiter(this, void 0, void 0, function* () {\n            const r = yield Promise.resolve(obj[key]);\n            resultObj[key] = r;\n        }));\n        return Promise.all(promises).then(() => resultObj);\n    });\n}\nexports.promiseProps = promiseProps;\n"]},"metadata":{},"sourceType":"script"}