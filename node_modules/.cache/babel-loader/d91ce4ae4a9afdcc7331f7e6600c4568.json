{"ast":null,"code":"\"use strict\";\n\nvar __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function step(result) {\n      result.done ? resolve(result.value) : new P(function (resolve) {\n        resolve(result.value);\n      }).then(fulfilled, rejected);\n    }\n\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nconst fs = require(\"fs\");\n\nconst api = require(\"../api\");\n\nconst error_1 = require(\"../error\");\n\nconst logger = require(\"../logger\");\n\nconst operation_poller_1 = require(\"../operation-poller\");\n\nconst TIMEOUT_MILLIS = 30000;\nconst APP_LIST_PAGE_SIZE = 100;\nconst CREATE_APP_API_REQUEST_TIMEOUT_MILLIS = 15000;\nconst WEB_CONFIG_FILE_NAME = \"google-config.js\";\nvar AppPlatform;\n\n(function (AppPlatform) {\n  AppPlatform[\"PLATFORM_UNSPECIFIED\"] = \"PLATFORM_UNSPECIFIED\";\n  AppPlatform[\"IOS\"] = \"IOS\";\n  AppPlatform[\"ANDROID\"] = \"ANDROID\";\n  AppPlatform[\"WEB\"] = \"WEB\";\n  AppPlatform[\"ANY\"] = \"ANY\";\n})(AppPlatform = exports.AppPlatform || (exports.AppPlatform = {}));\n\nfunction getAppPlatform(platform) {\n  switch (platform.toUpperCase()) {\n    case \"IOS\":\n      return AppPlatform.IOS;\n\n    case \"ANDROID\":\n      return AppPlatform.ANDROID;\n\n    case \"WEB\":\n      return AppPlatform.WEB;\n\n    case \"\":\n      return AppPlatform.ANY;\n\n    default:\n      throw new error_1.FirebaseError(\"Unexpected platform. Only iOS, Android, and Web apps are supported\");\n  }\n}\n\nexports.getAppPlatform = getAppPlatform;\n\nfunction createIosApp(projectId, options) {\n  return __awaiter(this, void 0, void 0, function* () {\n    try {\n      const response = yield api.request(\"POST\", `/v1beta1/projects/${projectId}/iosApps`, {\n        auth: true,\n        origin: api.firebaseApiOrigin,\n        timeout: CREATE_APP_API_REQUEST_TIMEOUT_MILLIS,\n        data: options\n      });\n      const appData = yield operation_poller_1.pollOperation({\n        pollerName: \"Create iOS app Poller\",\n        apiOrigin: api.firebaseApiOrigin,\n        apiVersion: \"v1beta1\",\n        operationResourceName: response.body.name\n      });\n      return appData;\n    } catch (err) {\n      logger.debug(err.message);\n      throw new error_1.FirebaseError(`Failed to create iOS app for project ${projectId}. See firebase-debug.log for more info.`, {\n        exit: 2,\n        original: err\n      });\n    }\n  });\n}\n\nexports.createIosApp = createIosApp;\n\nfunction createAndroidApp(projectId, options) {\n  return __awaiter(this, void 0, void 0, function* () {\n    try {\n      const response = yield api.request(\"POST\", `/v1beta1/projects/${projectId}/androidApps`, {\n        auth: true,\n        origin: api.firebaseApiOrigin,\n        timeout: CREATE_APP_API_REQUEST_TIMEOUT_MILLIS,\n        data: options\n      });\n      const appData = yield operation_poller_1.pollOperation({\n        pollerName: \"Create Android app Poller\",\n        apiOrigin: api.firebaseApiOrigin,\n        apiVersion: \"v1beta1\",\n        operationResourceName: response.body.name\n      });\n      return appData;\n    } catch (err) {\n      logger.debug(err.message);\n      throw new error_1.FirebaseError(`Failed to create Android app for project ${projectId}. See firebase-debug.log for more info.`, {\n        exit: 2,\n        original: err\n      });\n    }\n  });\n}\n\nexports.createAndroidApp = createAndroidApp;\n\nfunction createWebApp(projectId, options) {\n  return __awaiter(this, void 0, void 0, function* () {\n    try {\n      const response = yield api.request(\"POST\", `/v1beta1/projects/${projectId}/webApps`, {\n        auth: true,\n        origin: api.firebaseApiOrigin,\n        timeout: CREATE_APP_API_REQUEST_TIMEOUT_MILLIS,\n        data: options\n      });\n      const appData = yield operation_poller_1.pollOperation({\n        pollerName: \"Create Web app Poller\",\n        apiOrigin: api.firebaseApiOrigin,\n        apiVersion: \"v1beta1\",\n        operationResourceName: response.body.name\n      });\n      return appData;\n    } catch (err) {\n      logger.debug(err.message);\n      throw new error_1.FirebaseError(`Failed to create Web app for project ${projectId}. See firebase-debug.log for more info.`, {\n        exit: 2,\n        original: err\n      });\n    }\n  });\n}\n\nexports.createWebApp = createWebApp;\n\nfunction listFirebaseApps(projectId, platform, pageSize = APP_LIST_PAGE_SIZE) {\n  return __awaiter(this, void 0, void 0, function* () {\n    const apps = [];\n\n    try {\n      let nextPageToken = \"\";\n\n      do {\n        const pageTokenQueryString = nextPageToken ? `&pageToken=${nextPageToken}` : \"\";\n        const response = yield api.request(\"GET\", getListAppsResourceString(projectId, platform) + `?pageSize=${pageSize}${pageTokenQueryString}`, {\n          auth: true,\n          origin: api.firebaseApiOrigin,\n          timeout: TIMEOUT_MILLIS\n        });\n\n        if (response.body.apps) {\n          const appsOnPage = response.body.apps.map(app => app.platform ? app : Object.assign({}, app, {\n            platform\n          }));\n          apps.push(...appsOnPage);\n        }\n\n        nextPageToken = response.body.nextPageToken;\n      } while (nextPageToken);\n\n      return apps;\n    } catch (err) {\n      logger.debug(err.message);\n      throw new error_1.FirebaseError(`Failed to list Firebase ${platform === AppPlatform.ANY ? \"\" : platform + \" \"}` + \"apps. See firebase-debug.log for more info.\", {\n        exit: 2,\n        original: err\n      });\n    }\n  });\n}\n\nexports.listFirebaseApps = listFirebaseApps;\n\nfunction getListAppsResourceString(projectId, platform) {\n  let resourceSuffix;\n\n  switch (platform) {\n    case AppPlatform.IOS:\n      resourceSuffix = \"/iosApps\";\n      break;\n\n    case AppPlatform.ANDROID:\n      resourceSuffix = \"/androidApps\";\n      break;\n\n    case AppPlatform.WEB:\n      resourceSuffix = \"/webApps\";\n      break;\n\n    case AppPlatform.ANY:\n      resourceSuffix = \":searchApps\";\n      break;\n\n    default:\n      throw new error_1.FirebaseError(\"Unexpected platform. Only support iOS, Android and Web apps\");\n  }\n\n  return `/v1beta1/projects/${projectId}${resourceSuffix}`;\n}\n\nfunction getAppConfig(appId, platform) {\n  return __awaiter(this, void 0, void 0, function* () {\n    let response;\n\n    try {\n      response = yield api.request(\"GET\", getAppConfigResourceString(appId, platform), {\n        auth: true,\n        origin: api.firebaseApiOrigin,\n        timeout: TIMEOUT_MILLIS\n      });\n    } catch (err) {\n      logger.debug(err.message);\n      throw new error_1.FirebaseError(`Failed to get ${platform} app configuration. See firebase-debug.log for more info.`, {\n        exit: 2,\n        original: err\n      });\n    }\n\n    return parseConfigFromResponse(response.body, platform);\n  });\n}\n\nexports.getAppConfig = getAppConfig;\n\nfunction getAppConfigResourceString(appId, platform) {\n  let platformResource;\n\n  switch (platform) {\n    case AppPlatform.IOS:\n      platformResource = \"iosApps\";\n      break;\n\n    case AppPlatform.ANDROID:\n      platformResource = \"androidApps\";\n      break;\n\n    case AppPlatform.WEB:\n      platformResource = \"webApps\";\n      break;\n\n    default:\n      throw new error_1.FirebaseError(\"Unexpected app platform\");\n  }\n\n  return `/v1beta1/projects/-/${platformResource}/${appId}/config`;\n}\n\nfunction parseConfigFromResponse(responseBody, platform) {\n  if (platform === AppPlatform.WEB) {\n    const JS_TEMPLATE = fs.readFileSync(__dirname + \"/../../templates/setup/web.js\", \"utf8\");\n    return {\n      fileName: WEB_CONFIG_FILE_NAME,\n      fileContents: JS_TEMPLATE.replace(\"{/*--CONFIG--*/}\", JSON.stringify(responseBody, null, 2))\n    };\n  } else if (platform === AppPlatform.ANDROID || platform === AppPlatform.IOS) {\n    return {\n      fileName: responseBody.configFilename,\n      fileContents: Buffer.from(responseBody.configFileContents, \"base64\").toString(\"utf8\")\n    };\n  }\n\n  throw new error_1.FirebaseError(\"Unexpected app platform\");\n}","map":{"version":3,"sources":["/Users/Erik.Kroha1/Jobs/Verizon/Talk Home/sivr-caller-display/node_modules/firebase-tools/lib/management/apps.js"],"names":["__awaiter","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","value","step","next","e","rejected","result","done","then","apply","Object","defineProperty","exports","fs","require","api","error_1","logger","operation_poller_1","TIMEOUT_MILLIS","APP_LIST_PAGE_SIZE","CREATE_APP_API_REQUEST_TIMEOUT_MILLIS","WEB_CONFIG_FILE_NAME","AppPlatform","getAppPlatform","platform","toUpperCase","IOS","ANDROID","WEB","ANY","FirebaseError","createIosApp","projectId","options","response","request","auth","origin","firebaseApiOrigin","timeout","data","appData","pollOperation","pollerName","apiOrigin","apiVersion","operationResourceName","body","name","err","debug","message","exit","original","createAndroidApp","createWebApp","listFirebaseApps","pageSize","apps","nextPageToken","pageTokenQueryString","getListAppsResourceString","appsOnPage","map","app","assign","push","resourceSuffix","getAppConfig","appId","getAppConfigResourceString","parseConfigFromResponse","platformResource","responseBody","JS_TEMPLATE","readFileSync","__dirname","fileName","fileContents","replace","JSON","stringify","configFilename","Buffer","from","configFileContents","toString"],"mappings":"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","sourcesContent":["\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst fs = require(\"fs\");\nconst api = require(\"../api\");\nconst error_1 = require(\"../error\");\nconst logger = require(\"../logger\");\nconst operation_poller_1 = require(\"../operation-poller\");\nconst TIMEOUT_MILLIS = 30000;\nconst APP_LIST_PAGE_SIZE = 100;\nconst CREATE_APP_API_REQUEST_TIMEOUT_MILLIS = 15000;\nconst WEB_CONFIG_FILE_NAME = \"google-config.js\";\nvar AppPlatform;\n(function (AppPlatform) {\n    AppPlatform[\"PLATFORM_UNSPECIFIED\"] = \"PLATFORM_UNSPECIFIED\";\n    AppPlatform[\"IOS\"] = \"IOS\";\n    AppPlatform[\"ANDROID\"] = \"ANDROID\";\n    AppPlatform[\"WEB\"] = \"WEB\";\n    AppPlatform[\"ANY\"] = \"ANY\";\n})(AppPlatform = exports.AppPlatform || (exports.AppPlatform = {}));\nfunction getAppPlatform(platform) {\n    switch (platform.toUpperCase()) {\n        case \"IOS\":\n            return AppPlatform.IOS;\n        case \"ANDROID\":\n            return AppPlatform.ANDROID;\n        case \"WEB\":\n            return AppPlatform.WEB;\n        case \"\":\n            return AppPlatform.ANY;\n        default:\n            throw new error_1.FirebaseError(\"Unexpected platform. Only iOS, Android, and Web apps are supported\");\n    }\n}\nexports.getAppPlatform = getAppPlatform;\nfunction createIosApp(projectId, options) {\n    return __awaiter(this, void 0, void 0, function* () {\n        try {\n            const response = yield api.request(\"POST\", `/v1beta1/projects/${projectId}/iosApps`, {\n                auth: true,\n                origin: api.firebaseApiOrigin,\n                timeout: CREATE_APP_API_REQUEST_TIMEOUT_MILLIS,\n                data: options,\n            });\n            const appData = yield operation_poller_1.pollOperation({\n                pollerName: \"Create iOS app Poller\",\n                apiOrigin: api.firebaseApiOrigin,\n                apiVersion: \"v1beta1\",\n                operationResourceName: response.body.name,\n            });\n            return appData;\n        }\n        catch (err) {\n            logger.debug(err.message);\n            throw new error_1.FirebaseError(`Failed to create iOS app for project ${projectId}. See firebase-debug.log for more info.`, { exit: 2, original: err });\n        }\n    });\n}\nexports.createIosApp = createIosApp;\nfunction createAndroidApp(projectId, options) {\n    return __awaiter(this, void 0, void 0, function* () {\n        try {\n            const response = yield api.request(\"POST\", `/v1beta1/projects/${projectId}/androidApps`, {\n                auth: true,\n                origin: api.firebaseApiOrigin,\n                timeout: CREATE_APP_API_REQUEST_TIMEOUT_MILLIS,\n                data: options,\n            });\n            const appData = yield operation_poller_1.pollOperation({\n                pollerName: \"Create Android app Poller\",\n                apiOrigin: api.firebaseApiOrigin,\n                apiVersion: \"v1beta1\",\n                operationResourceName: response.body.name,\n            });\n            return appData;\n        }\n        catch (err) {\n            logger.debug(err.message);\n            throw new error_1.FirebaseError(`Failed to create Android app for project ${projectId}. See firebase-debug.log for more info.`, {\n                exit: 2,\n                original: err,\n            });\n        }\n    });\n}\nexports.createAndroidApp = createAndroidApp;\nfunction createWebApp(projectId, options) {\n    return __awaiter(this, void 0, void 0, function* () {\n        try {\n            const response = yield api.request(\"POST\", `/v1beta1/projects/${projectId}/webApps`, {\n                auth: true,\n                origin: api.firebaseApiOrigin,\n                timeout: CREATE_APP_API_REQUEST_TIMEOUT_MILLIS,\n                data: options,\n            });\n            const appData = yield operation_poller_1.pollOperation({\n                pollerName: \"Create Web app Poller\",\n                apiOrigin: api.firebaseApiOrigin,\n                apiVersion: \"v1beta1\",\n                operationResourceName: response.body.name,\n            });\n            return appData;\n        }\n        catch (err) {\n            logger.debug(err.message);\n            throw new error_1.FirebaseError(`Failed to create Web app for project ${projectId}. See firebase-debug.log for more info.`, { exit: 2, original: err });\n        }\n    });\n}\nexports.createWebApp = createWebApp;\nfunction listFirebaseApps(projectId, platform, pageSize = APP_LIST_PAGE_SIZE) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const apps = [];\n        try {\n            let nextPageToken = \"\";\n            do {\n                const pageTokenQueryString = nextPageToken ? `&pageToken=${nextPageToken}` : \"\";\n                const response = yield api.request(\"GET\", getListAppsResourceString(projectId, platform) +\n                    `?pageSize=${pageSize}${pageTokenQueryString}`, {\n                    auth: true,\n                    origin: api.firebaseApiOrigin,\n                    timeout: TIMEOUT_MILLIS,\n                });\n                if (response.body.apps) {\n                    const appsOnPage = response.body.apps.map((app) => (app.platform ? app : Object.assign({}, app, { platform })));\n                    apps.push(...appsOnPage);\n                }\n                nextPageToken = response.body.nextPageToken;\n            } while (nextPageToken);\n            return apps;\n        }\n        catch (err) {\n            logger.debug(err.message);\n            throw new error_1.FirebaseError(`Failed to list Firebase ${platform === AppPlatform.ANY ? \"\" : platform + \" \"}` +\n                \"apps. See firebase-debug.log for more info.\", {\n                exit: 2,\n                original: err,\n            });\n        }\n    });\n}\nexports.listFirebaseApps = listFirebaseApps;\nfunction getListAppsResourceString(projectId, platform) {\n    let resourceSuffix;\n    switch (platform) {\n        case AppPlatform.IOS:\n            resourceSuffix = \"/iosApps\";\n            break;\n        case AppPlatform.ANDROID:\n            resourceSuffix = \"/androidApps\";\n            break;\n        case AppPlatform.WEB:\n            resourceSuffix = \"/webApps\";\n            break;\n        case AppPlatform.ANY:\n            resourceSuffix = \":searchApps\";\n            break;\n        default:\n            throw new error_1.FirebaseError(\"Unexpected platform. Only support iOS, Android and Web apps\");\n    }\n    return `/v1beta1/projects/${projectId}${resourceSuffix}`;\n}\nfunction getAppConfig(appId, platform) {\n    return __awaiter(this, void 0, void 0, function* () {\n        let response;\n        try {\n            response = yield api.request(\"GET\", getAppConfigResourceString(appId, platform), {\n                auth: true,\n                origin: api.firebaseApiOrigin,\n                timeout: TIMEOUT_MILLIS,\n            });\n        }\n        catch (err) {\n            logger.debug(err.message);\n            throw new error_1.FirebaseError(`Failed to get ${platform} app configuration. See firebase-debug.log for more info.`, {\n                exit: 2,\n                original: err,\n            });\n        }\n        return parseConfigFromResponse(response.body, platform);\n    });\n}\nexports.getAppConfig = getAppConfig;\nfunction getAppConfigResourceString(appId, platform) {\n    let platformResource;\n    switch (platform) {\n        case AppPlatform.IOS:\n            platformResource = \"iosApps\";\n            break;\n        case AppPlatform.ANDROID:\n            platformResource = \"androidApps\";\n            break;\n        case AppPlatform.WEB:\n            platformResource = \"webApps\";\n            break;\n        default:\n            throw new error_1.FirebaseError(\"Unexpected app platform\");\n    }\n    return `/v1beta1/projects/-/${platformResource}/${appId}/config`;\n}\nfunction parseConfigFromResponse(responseBody, platform) {\n    if (platform === AppPlatform.WEB) {\n        const JS_TEMPLATE = fs.readFileSync(__dirname + \"/../../templates/setup/web.js\", \"utf8\");\n        return {\n            fileName: WEB_CONFIG_FILE_NAME,\n            fileContents: JS_TEMPLATE.replace(\"{/*--CONFIG--*/}\", JSON.stringify(responseBody, null, 2)),\n        };\n    }\n    else if (platform === AppPlatform.ANDROID || platform === AppPlatform.IOS) {\n        return {\n            fileName: responseBody.configFilename,\n            fileContents: Buffer.from(responseBody.configFileContents, \"base64\").toString(\"utf8\"),\n        };\n    }\n    throw new error_1.FirebaseError(\"Unexpected app platform\");\n}\n"]},"metadata":{},"sourceType":"script"}